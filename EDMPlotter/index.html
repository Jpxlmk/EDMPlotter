<!DOCTYPE html>
<html>
<head>
    <title>Experiment Control Panel</title>
    <link rel="stylesheet" type="text/css" href="css/containerstyle.css">
    <link rel="stylesheet" type="text/css" href="css/controlpanelstyle.css">
    <link rel="stylesheet" type="text/css" href="css/d3plotstyle.css">
</head>
<body>
    <div class="controlpanel">
        <!--<select id="expdropdown">
            <option value="None">Select experiment:</option>
        </select>-->
        <input type="button" id="plotbutton" value="Start" />
        <input type="button" id="stopplotbutton" value="Stop" />
        <input type="button" id="clearplotbutton" value="Clear" />
        <input type="button" id="savedatabutton" value="Save to" />
        <input type="text" id="savepathtextbox" value="C:\data\data.json" />
    </div>
    <div class="container">
        <svg id="plot" width="1000" height="500"></svg>
    </div>  

    <!--Script references. -->
    <!--Reference the jQuery library. -->
    <script src="Scripts/jquery-1.6.4.min.js" ></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <!--Reference to d3 library-->
    <script charset="utf-8" type="text/javascript" src="Scripts/d3.min.js"></script>
    <!--Add script to plot some data.-->
    <script src="js/d3plot.js" type="text/javascript"></script>
    <script type="text/javascript">
        //These control the server's data-pushing down to the client.
        $(function () {
            // Declare a proxy to reference the hub. 
            var pHub = $.connection.plotHub;

            // Create a function that the hub can call to plot the data.
            pHub.client.pushData = function (data) {
                //I am assuming that there is an svg object with id="plot". If there isn't, this will fail.
                plotData("#" + "plot", JSON.parse(data));
            };

            pHub.client.clearData = function () {
                clearData("#" + "plot");
            }

            //Populates the drop-down menu of experiments
            /*pHub.client.pushExperimentList = function (exps) {
                var jsonExp = JSON.parse(exps);
                var opts = '<option value="None">Select experiment:</option>';
                $.each(jsonExp, function (key, item) { opts += '<option value="' + item.name + '">' + item.name + '</option>'; });
                $('#expdropdown').html(opts);
            };*/

                    // Start the connection, and start plotting!
                $.connection.hub.start().done(function () {
                    $('#plotbutton').click(function () {
                    // Call the StartPlotting method on the hub. 
                    pHub.server.startPlotting();

                });
                    // Stop plotting
                $('#stopplotbutton').click(function () {
                    // Call the StopPlotting method on the hub. 
                    pHub.server.stopPlotting();

                });
                
                    //Clears Plot
                $('#clearplotbutton').click(function () {
                    // Call the StopPlotting method on the hub. 
                    pHub.server.clearAll();

                });

                $('#savedatabutton').click(function () {
                    pHub.server.save($('#savepathtextbox').val());
                });

                    /*
                $('#expdropdown').click(function () {
                    //Gets list of available experiments.
                    pHub.server.getListOfAvailableExperiments();
                });*/

            });
            
        });
    </script>
</body>
</html>